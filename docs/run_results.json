{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.6", "generated_at": "2025-08-07T05:06:37.585988Z", "invocation_id": "8c3a479f-be55-494e-8328-2c0e2517c98f", "invocation_started_at": "2025-08-07T05:06:33.787466Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.127219Z", "completed_at": "2025-08-07T05:06:37.139838Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.140599Z", "completed_at": "2025-08-07T05:06:37.140620Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015125036239624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.SDG_Vault_demo.prueba", "compiled": true, "compiled_code": "select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.CUSTOMER", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.144227Z", "completed_at": "2025-08-07T05:06:37.154349Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.154871Z", "completed_at": "2025-08-07T05:06:37.154881Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012596368789672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.bridge_pedidos", "compiled": true, "compiled_code": "\n\nwith\n    bridge_pedido as (\n        select\n            md5(\n                upper(trim(nvl(hp.clave_pedido, '')))\n                || upper(trim(nvl(hp.empleado, '')))\n                || upper(trim(nvl(hc.nombre_cliente, '')))\n                || upper(trim(nvl(hn.nombre_pais, '')))\n            ) as bridge_pedido_id,\n            greatest(lcp.fecha_carga, lpc.fecha_carga) as fecha_carga,\n            hp.hub_pedido_id,\n            hp.clave_pedido,\n            hp.empleado,\n            lcp.lnk_cliente_pedido_id,\n            hc.hub_cliente_id,\n            hc.nombre_cliente,\n            lpc.lnk_pais_cliente_id,\n            hn.hub_pais_id,\n            hn.nombre_pais\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PEDIDOS hp\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_CLIENTES_PEDIDOS lcp\n            on hp.hub_pedido_id = lcp.hub_pedido_id\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES hc\n            on hc.hub_cliente_id = lcp.hub_cliente_id\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_PAISES_CLIENTES lpc\n            on lpc.hub_cliente_id = hc.hub_cliente_id\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PAISES hn on hn.hub_pais_id = lpc.hub_pais_id\n    )\nselect *\nfrom bridge_pedido\n\n\n    where bridge_pedido_id not in (select bridge_pedido_id from SDGVAULTMART.DBT_SDGVAULT_BRONZE.bridge_pedidos)\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.bridge_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.156223Z", "completed_at": "2025-08-07T05:06:37.160452Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.160707Z", "completed_at": "2025-08-07T05:06:37.160711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050506591796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.dim1_clientes", "compiled": true, "compiled_code": "\nwith\n    dim1_clientes as (\n        select\n            hc.hub_cliente_id as dim1_cliente_id,\n            hc.nombre_cliente,\n            sc.segmento_marketing,\n            sc.fecha_carga as fecha,\n            sc.c_origen as origen\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES hc\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.PIT_CLIENTES pit\n            on hc.hub_cliente_id = pit.hub_cliente_id\n        left join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CUENTA sc\n            on sc.hub_cliente_id = pit.hub_cliente_id\n            and sc.fecha_carga = pit.fecha_cliente_cuenta\n            and sc.fecha_carga = (\n                select max(sc2.fecha_carga)\n                from SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CUENTA sc2\n                where sc.hub_cliente_id = sc2.hub_cliente_id\n            )\n    )\n\n        ,\n        filtrado as (\n            select s.*\n            from dim1_clientes s\n            left join\n                SDGVAULTMART.DBT_SDGVAULT_GOLD.dim1_clientes t\n                on s.dim1_cliente_id = t.dim1_cliente_id\n                and s.nombre_cliente = t.nombre_cliente\n                and s.segmento_marketing = t.segmento_marketing\n                and s.fecha = t.fecha\n            where t.dim1_cliente_id is null\n        )\n    select *\n    from filtrado\n\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_GOLD.dim1_clientes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.161689Z", "completed_at": "2025-08-07T05:06:37.166469Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.166795Z", "completed_at": "2025-08-07T05:06:37.166801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005582094192504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.dim1_paises", "compiled": true, "compiled_code": "\n\nwith\n    dim1_paises as (\n        select\n            rp.hub_pais_id as dim1_pais_id,\n            rp.hub_region_id as dim1_region_id,\n            rp.nombre_pais,\n            rp.nombre_region,\n            rp.fecha_carga as fecha_actual,\n            rp.origen_pais as origen\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_REGIONES_PAISES rp\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_PAISES sp on rp.hub_pais_id = sp.hub_pais_id\n        where\n            sp.fecha_carga = (\n                select max(sp2.fecha_carga)\n                from SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_PAISES sp2\n                where sp2.hub_pais_id = sp.hub_pais_id\n            )\n\n    )\n\n        ,\n        filtrado as (\n            select s.*\n            from dim1_paises s\n            left join\n                SDGVAULTMART.DBT_SDGVAULT_SILVER.dim1_paises t\n                on s.dim1_pais_id = t.dim1_pais_id\n                and s.dim1_region_id = t.dim1_region_id\n                and s.nombre_pais = t.nombre_pais\n                and s.nombre_region = t.nombre_region\n                and s.fecha_actual = t.fecha_actual\n            where t.dim1_pais_id is null\n        )\n    select *\n    from filtrado\n\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_SILVER.dim1_paises", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.167912Z", "completed_at": "2025-08-07T05:06:37.171711Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.171974Z", "completed_at": "2025-08-07T05:06:37.171978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004548549652099609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.dim2_clientes", "compiled": true, "compiled_code": "\n\nwith fuente as (\n\n    select\n        sc.hub_cliente_id,\n        hc.nombre_cliente,\n        sc.segmento_marketing,\n        sc.c_origen as origen,\n        sc.fecha_carga as fecha_inicial_validez\n    from SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CUENTA sc\n    join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES hc\n        on sc.hub_cliente_id = hc.hub_cliente_id\n\n)\n\n\n\n-- INCREMENTAL: detectar cambios y versionar\n\n-- \u00daltimo registro insertado por cliente\n, registro_actual as (\n    select *\n    from SDGVAULTMART.DBT_SDGVAULT_SILVER.dim2_clientes\n    qualify row_number() over (partition by hub_cliente_id order by fecha_inicial_validez desc) = 1\n)\n\n-- Nuevos datos desde el origen\n, nuevos_datos as (\n    select *\n    from fuente\n)\n\n-- Detectar cambios en valores comparables\n, cambios as (\n    select\n        n.hub_cliente_id,\n        n.nombre_cliente,\n        n.segmento_marketing,\n        n.origen,\n        n.fecha_inicial_validez,\n        null as fecha_final_validez,\n        md5(upper(trim(coalesce(n.nombre_cliente, '')))\n            || trim(coalesce(n.segmento_marketing, ''))\n            || to_char(n.fecha_inicial_validez, 'YYYY-MM-DD')) as dim2_cliente_id\n    from nuevos_datos n\n    left join registro_actual r\n        on n.hub_cliente_id = r.hub_cliente_id\n    where r.hub_cliente_id is null\n       or r.segmento_marketing != n.segmento_marketing\n       or r.nombre_cliente != n.nombre_cliente\n)\n\n-- Actualizar fecha_final_validez en la versi\u00f3n anterior\n, cerrar_versiones as (\n    select\n        r.dim2_cliente_id,\n        r.hub_cliente_id,\n        r.nombre_cliente,\n        r.segmento_marketing,\n        r.origen,\n        r.fecha_inicial_validez,\n        c.fecha_inicial_validez as fecha_final_validez\n    from registro_actual r\n    join cambios c\n        on r.hub_cliente_id = c.hub_cliente_id\n)\n\n-- Uni\u00f3n: nuevas versiones + cierre versiones anteriores\nselect * from cambios\nunion all\nselect\n    md5(upper(trim(coalesce(nombre_cliente, '')))\n        || trim(coalesce(segmento_marketing, ''))\n        || to_char(fecha_inicial_validez, 'YYYY-MM-DD')) as dim2_cliente_id,\n    hub_cliente_id,\n    nombre_cliente,\n    segmento_marketing,\n    origen,\n    fecha_inicial_validez,\n    fecha_final_validez\nfrom cerrar_versiones\n\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_SILVER.dim2_clientes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.172969Z", "completed_at": "2025-08-07T05:06:37.176518Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.176778Z", "completed_at": "2025-08-07T05:06:37.176782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00427556037902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.fact_clientes_cuentas", "compiled": true, "compiled_code": "\n\nwith\n    max_fecha as (\n        select hub_cliente_id, max(fecha_carga) as fecha_cliente_cuenta\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CUENTA\n        group by hub_cliente_id\n    ),\n    pit_enriquecido as (\n        select pit.hub_cliente_id, mf.fecha_cliente_cuenta\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.PIT_CLIENTES pit\n        join max_fecha mf on pit.hub_cliente_id = mf.hub_cliente_id\n    ),\n    fact_clientes_cuentas as (\n        select\n            pit.hub_cliente_id,\n            sc.cuenta_balance,\n            sc.fecha_carga as fecha,\n            sc.c_origen as origen\n        from pit_enriquecido pit\n        left join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CUENTA sc\n            on sc.hub_cliente_id = pit.hub_cliente_id\n            and sc.fecha_carga = pit.fecha_cliente_cuenta\n    )\n-- Solo inserta registros que no existen a\u00fan en la tabla de hechos\nselect *\nfrom fact_clientes_cuentas f\n\n    where\n        not exists (\n            select 1\n            from SDGVAULTMART.DBT_SDGVAULT_SILVER.fact_clientes_cuentas t\n            where f.hub_cliente_id = t.hub_cliente_id and f.fecha = t.fecha\n        )\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_SILVER.fact_clientes_cuentas", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.177779Z", "completed_at": "2025-08-07T05:06:37.184404Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.184720Z", "completed_at": "2025-08-07T05:06:37.184726Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007417440414428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.fact_clientes_pedidos", "compiled": true, "compiled_code": "\n\nwith\n    base as (\n        select\n            bp.hub_pedido_id,\n            bp.hub_cliente_id,\n            bp.hub_pais_id,\n            bp.fecha_carga,\n            lp.linea_pedido,\n            sp.precio_total\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.BRIDGE_PEDIDOS bp\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_PEDIDOS sp on bp.hub_pedido_id = sp.hub_pedido_id\n        LEFT join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_PEDIDOS_LINEAS_PEDIDOS lp\n            on bp.hub_pedido_id = lp.hub_pedido_id\n\n        \n            -- Solo considerar nuevas fechas de carga en modo incremental\n            where bp.fecha_carga > (select max(fecha_carga) from SDGVAULTMART.DBT_SDGVAULT_GOLD.fact_clientes_pedidos)\n        \n    ),\n    agregado as (\n        select\n            hub_pedido_id,\n            hub_cliente_id,\n            hub_pais_id,\n            fecha_carga,\n            sum(precio_total) as precio_total_acumulado,\n            sum(linea_pedido) as cantidad_lineas_pedido\n        from base\n        group by hub_pedido_id, hub_cliente_id, hub_pais_id, fecha_carga\n    )\nselect *\nfrom agregado\n--ORDER BY fecha_carga DESC", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_GOLD.fact_clientes_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.185799Z", "completed_at": "2025-08-07T05:06:37.188919Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.189193Z", "completed_at": "2025-08-07T05:06:37.189198Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038938522338867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_clientes", "compiled": true, "compiled_code": "\n\nwith\n    hub_paises as (\n        \n            select\n                md5(upper(trim(nvl(c_name, '')))) as hub_cliente_id,\n                c_name as nombre_cliente,\n                load_date as fecha_carga,\n                c_origen as origen\n            from SDGVAULTMART.DBT_SDGVAULT.STG_CLIENTES\n            where c_name not in (select nombre_cliente from SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_clientes)\n        \n    )\nselect *\nfrom hub_paises", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_clientes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.190286Z", "completed_at": "2025-08-07T05:06:37.192988Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.193275Z", "completed_at": "2025-08-07T05:06:37.193279Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035119056701660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_lineas_pedidos", "compiled": true, "compiled_code": "with\n    hub_lineas_pedidos as (\n        select\n            md5(\n                upper(trim(nvl(l_orderkey, ''))) || upper(trim(nvl(l_linenumber, '')))\n            ) as hub_lineas_pedido_id,\n            l_orderkey as clave_pedido,\n            l_linenumber as linea_pedido,\n            current_date as fecha_carga,\n            l_origen as origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_LINEAS_PEDIDO\n    )\nselect *\nfrom hub_lineas_pedidos", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_lineas_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.194757Z", "completed_at": "2025-08-07T05:06:37.198331Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.198655Z", "completed_at": "2025-08-07T05:06:37.198664Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004792213439941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_paises", "compiled": true, "compiled_code": "\n\nwith\n    hub_paises as (\n        \n            select\n                md5(upper(trim(nvl(n_name, '')))) as hub_pais_id,\n                n_name as nombre_pais,\n                load_date as fecha_carga,\n                n_origen as origen\n            from SDGVAULTMART.DBT_SDGVAULT.STG_PAISES\n            where n_name not in (select nombre_pais from SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_paises)\n        \n    )\nselect *\nfrom hub_paises", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_paises", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.199882Z", "completed_at": "2025-08-07T05:06:37.202577Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.202886Z", "completed_at": "2025-08-07T05:06:37.202891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003601551055908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_partes", "compiled": true, "compiled_code": "with\n    hub_partes as (\n        select\n            md5(\n                upper(trim(nvl(p_name, ''))) || upper(trim(nvl(p_brand, '')))\n            ) as hub_parte_id,\n            p_name as nombre_parte,\n            p_brand as nombre_marca,\n            current_date as fecha_carga,\n            p_origen as origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PARTES\n    )\nselect *\nfrom hub_partes", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_partes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.204103Z", "completed_at": "2025-08-07T05:06:37.208326Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.208639Z", "completed_at": "2025-08-07T05:06:37.208644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005120038986206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_pedidos", "compiled": true, "compiled_code": "\n\nwith\n    hub_pedidos as (\n        \n            select\n                md5(\n                    upper(trim(nvl(o_orderkey, ''))) || upper(trim(nvl(o_clerk, '')))\n                ) as hub_pedido_id,\n                o_orderkey as clave_pedido,\n                o_clerk as empleado,\n                load_date as fecha_carga,\n                o_origen as origen\n            from SDGVAULTMART.DBT_SDGVAULT.STG_PEDIDOS\n            where\n                (o_orderkey, o_clerk)\n                not in (select clave_pedido, empleado from SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_pedidos)\n        \n    )\nselect *\nfrom hub_pedidos", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.209839Z", "completed_at": "2025-08-07T05:06:37.212699Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.213019Z", "completed_at": "2025-08-07T05:06:37.213024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037505626678466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_proveedores", "compiled": true, "compiled_code": "with\n    hub_proveedores as (\n        select\n            md5(upper(trim(nvl(s_name, '')))) as hub_proveedor_id,\n            s_name as nombre_proveedor,\n            current_date as fecha_carga,\n            s_origen as origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES\n    )\nselect *\nfrom hub_proveedores", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_proveedores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.214335Z", "completed_at": "2025-08-07T05:06:37.217131Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.217459Z", "completed_at": "2025-08-07T05:06:37.217465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003756284713745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.hub_regiones", "compiled": true, "compiled_code": "with\n    hub_regiones as (\n        select\n            md5(upper(trim(nvl(r_name, '')))) as hub_region_id,\n            r_name as nombre_region,\n            current_date as fecha_carga,\n            r_origen as origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_REGIONES\n    )\nselect *\nfrom hub_regiones", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.hub_regiones", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.218801Z", "completed_at": "2025-08-07T05:06:37.224036Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.224371Z", "completed_at": "2025-08-07T05:06:37.224376Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006211757659912109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_clientes_pedidos", "compiled": true, "compiled_code": "\n\nwith\n    hub_clientes as (\n        select hub_cliente_id, nombre_cliente, from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES\n    ),\n    hub_pedidos as (\n        select hub_pedido_id, clave_pedido, empleado  -- , fecha_carga\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PEDIDOS\n    ),\n    stg_clientes_pedidos as (\n        select a.c_name, b.o_orderkey, b.o_clerk, a.c_origen, b.o_origen, b.load_date\n        from SDGVAULTMART.DBT_SDGVAULT.STG_CLIENTES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PEDIDOS b\n        where a.c_custkey = b.o_custkey\n    ),\n    combinaciones as (\n        select\n            md5(\n                upper(trim(nvl(p1.nombre_cliente, '')))\n                || upper(trim(nvl(clave_pedido, '')))\n                || upper(trim(nvl(empleado, '')))\n            ) as lnk_cliente_pedido_id,\n            p1.hub_cliente_id,\n            p2.hub_pedido_id,\n            p1.nombre_cliente,\n            p2.clave_pedido,\n            p2.empleado,\n            p3.load_date as fecha_carga,\n            p3.c_origen as origen_cliente,\n            p3.o_origen as origen_pedido\n        from hub_clientes p1, hub_pedidos p2, stg_clientes_pedidos p3\n        where\n            p1.nombre_cliente = p3.c_name\n            and (p2.clave_pedido = p3.o_orderkey and p2.empleado = p3.o_clerk)\n    )\n\nselect *\nfrom combinaciones\n\n\n    where lnk_cliente_pedido_id not in (select lnk_cliente_pedido_id from SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_clientes_pedidos)\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_clientes_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.225694Z", "completed_at": "2025-08-07T05:06:37.230800Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.231157Z", "completed_at": "2025-08-07T05:06:37.231163Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060999393463134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_paises_clientes", "compiled": true, "compiled_code": "\n\nwith\n    hub_paises as (\n        select hub_pais_id, nombre_pais from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PAISES\n    ),\n    hub_clientes as (\n        select hub_cliente_id, nombre_cliente, fecha_carga\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES\n    ),\n    stg_paises_clientes as (\n        select a.n_name, b.c_name, a.n_origen, b.c_origen, b.load_date\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PAISES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_CLIENTES b\n        where a.n_nationkey = b.c_nationkey\n    ),\n    combinaciones as (\n        select\n            md5(\n                upper(trim(nvl(p1.nombre_pais, '')))\n                || upper(trim(nvl(p2.nombre_cliente, '')))\n            ) as lnk_pais_cliente_id,\n            p1.hub_pais_id,\n            p2.hub_cliente_id,\n            p1.nombre_pais,\n            p2.nombre_cliente,\n            p3.load_date as fecha_carga,\n            p3.n_origen as origen_pais,\n            p3.c_origen as origen_cliente\n        from hub_paises p1, hub_clientes p2, stg_paises_clientes p3\n        where p1.nombre_pais = p3.n_name and p2.nombre_cliente = p3.c_name\n    )\n\nselect *\nfrom combinaciones\n\n\n    where lnk_pais_cliente_id not in (select lnk_pais_cliente_id from SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_paises_clientes)\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_paises_clientes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.232526Z", "completed_at": "2025-08-07T05:06:37.237831Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.238189Z", "completed_at": "2025-08-07T05:06:37.238195Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0063190460205078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_paises_proveedores", "compiled": true, "compiled_code": "\n\nwith\n    hub_paises as (\n        select hub_pais_id, nombre_pais from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PAISES\n    ),\n    hub_proveedores as (\n        select hub_proveedor_id, nombre_proveedor, fecha_carga\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PROVEEDORES\n    ),\n    stg_paises_proveedores as (\n        select a.n_name, b.s_name, a.n_origen, b.s_origen--, b.load_date\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PAISES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES b on a.n_nationkey = b.s_nationkey\n    ),\n    combinaciones as (\n        select\n            md5(\n                upper(trim(coalesce(p1.nombre_pais, '')))\n                || upper(trim(coalesce(p2.nombre_proveedor, '')))\n            ) as lnk_pais_proveedor_id,\n            p1.hub_pais_id,\n            p2.hub_proveedor_id,\n            p1.nombre_pais,\n            p2.nombre_proveedor,\n            p2.fecha_carga,\n            p3.n_origen as origen_pais,\n            p3.s_origen as origen_proveedor\n        from hub_paises p1\n        join stg_paises_proveedores p3 on p1.nombre_pais = p3.n_name\n        join hub_proveedores p2 on p2.nombre_proveedor = p3.s_name\n    )\n\nselect *\nfrom combinaciones\n\n\n    -- Evita insertar v\u00ednculos ya existentes\n    where lnk_pais_proveedor_id not in (select lnk_pais_proveedor_id from SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_paises_proveedores)\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_paises_proveedores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.239558Z", "completed_at": "2025-08-07T05:06:37.243867Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.244230Z", "completed_at": "2025-08-07T05:06:37.244235Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005326747894287109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_partes_lineas_pedidos", "compiled": true, "compiled_code": "with\n    hub_partes as (\n        select hub_parte_id, nombre_parte, nombre_marca\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PARTES\n    ),\n    hub_lineas_pedidos as (\n        select hub_lineas_pedido_id, clave_pedido, linea_pedido\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_LINEAS_PEDIDOS\n    ),\n    stg_partes_lineas_pedidos as (\n        select a.p_name, a.p_brand, b.l_orderkey, b.l_linenumber, a.p_origen, b.l_origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PARTES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_LINEAS_PEDIDO b\n        where a.p_partkey = b.l_partkey\n    )\nselect\n    md5(\n        upper(trim(nvl(nombre_parte, '')))\n        || upper(trim(nvl(nombre_marca, '')))\n        || upper(trim(nvl(l_orderkey, '')))\n        || upper(trim(nvl(l_linenumber, '')))\n    ) as lnk_parte_lin_pedido_id,\n    p1.hub_parte_id,\n    p2.hub_lineas_pedido_id,\n    p1.nombre_parte,\n    p1.nombre_marca,\n    p2.clave_pedido,\n    p2.linea_pedido,\n    current_date as fecha_carga,\n    p3.p_origen as origen_parte,\n    p3.l_origen as origen_linea_pedido\nfrom hub_partes p1, hub_lineas_pedidos p2, stg_partes_lineas_pedidos p3\nwhere\n    (p1.nombre_parte = p3.p_name and p1.nombre_marca = p3.p_brand)\n    and (p2.clave_pedido = p3.l_orderkey and p2.linea_pedido = p3.l_linenumber)", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_partes_lineas_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.245622Z", "completed_at": "2025-08-07T05:06:37.249897Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.250282Z", "completed_at": "2025-08-07T05:06:37.250287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005326986312866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_pedidos_lineas_pedidos", "compiled": true, "compiled_code": "with\n    hub_pedidos as (\n        select hub_pedido_id, clave_pedido, empleado\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PEDIDOS\n    ),\n    hub_lineas_pedidos as (\n        select hub_lineas_pedido_id, clave_pedido, linea_pedido\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_LINEAS_PEDIDOS\n    ),\n    stg_pedidos_lineas_pedidos as (\n        select\n            a.o_orderkey,\n            a.o_clerk,\n            b.l_orderkey,\n            b.l_linenumber,\n            a.o_origen,\n            b.l_origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PEDIDOS a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_LINEAS_PEDIDO b\n        where a.o_orderkey = b.l_orderkey\n    )\nselect\n    md5(\n        upper(trim(nvl(o_orderkey, '')))\n        || upper(trim(nvl(o_clerk, '')))\n        || upper(trim(nvl(l_orderkey, '')))\n        || upper(trim(nvl(l_linenumber, '')))\n    ) as lnk_pedido_lin_pedido_id,\n    p1.hub_pedido_id,\n    p2.hub_lineas_pedido_id,\n    p1.clave_pedido,\n    p1.empleado,\n    p2.linea_pedido,\n    current_date as fecha_carga,\n    p3.o_origen as origen_pedido,\n    p3.l_origen as origen_linea_pedido\nfrom hub_pedidos p1, hub_lineas_pedidos p2, stg_pedidos_lineas_pedidos p3\nwhere\n    (p1.clave_pedido = p3.o_orderkey and p1.empleado = p3.o_clerk)\n    and (p2.clave_pedido = p3.l_orderkey and p2.linea_pedido = p3.l_linenumber)", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_pedidos_lineas_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.251719Z", "completed_at": "2025-08-07T05:06:37.256493Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.256868Z", "completed_at": "2025-08-07T05:06:37.256874Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0058362483978271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_proveedores_lineas_pedidos", "compiled": true, "compiled_code": "with\n    hub_proveedores as (\n        select hub_proveedor_id, nombre_proveedor\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PROVEEDORES\n    ),\n    hub_lineas_pedidos as (\n        select hub_lineas_pedido_id, clave_pedido, linea_pedido\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_LINEAS_PEDIDOS\n    ),\n    stg_proveedores_lineas_pedidos as (\n        select a.s_name, b.l_orderkey, b.l_linenumber, a.s_origen, b.l_origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_LINEAS_PEDIDO b\n        where a.s_suppkey = b.l_suppkey\n    )\nselect\n    md5(\n        upper(trim(nvl(nombre_proveedor, '')))\n        || upper(trim(nvl(l_orderkey, '')))\n        || upper(trim(nvl(l_linenumber, '')))\n    ) as lnk_proveedor_lin_pedido_id,\n    p1.hub_proveedor_id,\n    p2.hub_lineas_pedido_id,\n    p1.nombre_proveedor,\n    p2.clave_pedido,\n    p2.linea_pedido,\n    current_date as fecha_carga,\n    p3.s_origen as origen_proveedor,\n    p3.l_origen as origen_linea_pedido\nfrom hub_proveedores p1, hub_lineas_pedidos p2, stg_proveedores_lineas_pedidos p3\nwhere\n    p1.nombre_proveedor = p3.s_name\n    and (p2.clave_pedido = p3.l_orderkey and p2.linea_pedido = p3.l_linenumber)", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_proveedores_lineas_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.258373Z", "completed_at": "2025-08-07T05:06:37.262849Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.263218Z", "completed_at": "2025-08-07T05:06:37.263224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005550384521484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_proveedores_partes", "compiled": true, "compiled_code": "with\n    hub_proveedores as (\n        select hub_proveedor_id, nombre_proveedor,\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PROVEEDORES\n    ),\n    hub_partes as (\n        select hub_parte_id, nombre_parte, nombre_marca\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PARTES\n    ),\n    stg_proveedores_partes as (\n        select a.s_name, c.p_name, c.p_brand, a.s_origen, c.p_origen\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PARTES_PROVEEDOR b on a.s_suppkey = b.ps_suppkey\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PARTES c on b.ps_partkey = c.p_partkey\n    )\nselect\n    md5(\n        upper(trim(nvl(p1.nombre_proveedor, '')))\n        || upper(trim(nvl(p2.nombre_parte, '')))\n        || upper(trim(nvl(p2.nombre_marca, '')))\n    ) as lnk_proveedor_parte_id,\n    p1.hub_proveedor_id,\n    p2.hub_parte_id,\n    p1.nombre_proveedor,\n    p2.nombre_parte,\n    p2.nombre_marca,\n    current_date as fecha_carga,\n    p3.s_origen as origen_proveedor,\n    p3.p_origen as origen_parte\nfrom hub_proveedores p1, hub_partes p2, stg_proveedores_partes p3\nwhere\n    p1.nombre_proveedor = p3.s_name\n    and (p2.nombre_parte = p3.p_name and p2.nombre_marca = p3.p_brand)", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_proveedores_partes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.264712Z", "completed_at": "2025-08-07T05:06:37.270007Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.270398Z", "completed_at": "2025-08-07T05:06:37.270404Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006390094757080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.lnk_regiones_paises", "compiled": true, "compiled_code": "\n\nwith\n    hub_regiones as (\n        select hub_region_id, nombre_region from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_REGIONES\n    ),\n    hub_paises as (\n        select hub_pais_id, nombre_pais, fecha_carga\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PAISES\n    ),\n    stg_regiones_paises as (\n        select a.n_name, b.r_name, a.n_origen, b.r_origen, a.load_date\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PAISES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_REGIONES b\n        where a.n_regionkey = b.r_regionkey\n    ),\n    combinaciones as (\n        select\n            md5(\n                upper(trim(nvl(p1.nombre_region, '')))\n                || upper(trim(nvl(p2.nombre_pais, '')))\n            ) as lnk_regiones_paises_id,\n            p1.hub_region_id,\n            p2.hub_pais_id,\n            p1.nombre_region,\n            p2.nombre_pais,\n            p3.load_date as fecha_carga,\n            p3.r_origen as origen_region,\n            p3.n_origen as origen_pais\n        from hub_regiones p1, hub_paises p2, stg_regiones_paises p3\n        where p1.nombre_region = p3.r_name and p2.nombre_pais = p3.n_name\n    )\n\nselect *\nfrom combinaciones\n\n\n    where lnk_regiones_paises_id not in (select lnk_regiones_paises_id from SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_regiones_paises)\n", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.lnk_regiones_paises", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.271924Z", "completed_at": "2025-08-07T05:06:37.277823Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.278202Z", "completed_at": "2025-08-07T05:06:37.278209Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070035457611083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.pit_clientes", "compiled": true, "compiled_code": "-- Tabla PIT PIT_CLIENTES para la obtenci\u00f3n eficiente del hist\u00f3rico persistido en las\n-- tablas satelites de Cliente\n\n\nwith\n    sat_contacto as (\n        select hub_cliente_id, max(fecha_carga) as fecha_cliente_contacto\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CONTACTO\n        group by hub_cliente_id\n    ),\n    sat_cuenta as (\n        select hub_cliente_id, max(fecha_carga) as fecha_cliente_cuenta\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_CLIENTES_CUENTA\n        group by hub_cliente_id\n    ),\n    pit_clientes as (\n        select\n            h.hub_cliente_id,\n            greatest(\n                coalesce(fecha_cliente_contacto, date '1900-01-01'),\n                coalesce(fecha_cliente_cuenta, date '1900-01-01')\n            ) as pit_fecha,\n            s1.fecha_cliente_contacto,\n            s2.fecha_cliente_cuenta\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES h\n        left join sat_contacto s1 on h.hub_cliente_id = s1.hub_cliente_id\n        left join sat_cuenta s2 on h.hub_cliente_id = s2.hub_cliente_id\n    ),\n\n    filtrado as (\n\n        \n\n            select p.*\n            from pit_clientes p\n            left join\n                SDGVAULTMART.DBT_SDGVAULT_BRONZE.pit_clientes t\n                on p.hub_cliente_id = t.hub_cliente_id\n                and p.fecha_cliente_contacto = t.fecha_cliente_contacto\n                and p.fecha_cliente_cuenta = t.fecha_cliente_cuenta\n            where t.hub_cliente_id is null\n\n        \n\n    )\nselect *\nfrom filtrado", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.pit_clientes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.279671Z", "completed_at": "2025-08-07T05:06:37.284582Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.285005Z", "completed_at": "2025-08-07T05:06:37.285012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006033420562744141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_clientes_contacto", "compiled": true, "compiled_code": "\n\nwith\n    sat_clientes_contacto as (\n        select\n            b.hub_cliente_id,\n            b.fecha_carga,\n            md5(\n                upper(trim(nvl(c_address, '')))\n                || upper(trim(nvl(c_comment, '')))\n                || upper(trim(nvl(c_phone, '')))\n            ) as foto_cliente,\n            a.c_origen,\n            a.c_address as direccion,\n            a.c_comment as comentario,\n            a.c_phone as telefono\n        from SDGVAULTMART.DBT_SDGVAULT.STG_CLIENTES a\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES b on a.c_name = b.nombre_cliente\n        \n            where\n                not exists (\n                    select 1\n                    from SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_clientes_contacto s\n                    where\n                        s.hub_cliente_id = b.hub_cliente_id\n                        and s.foto_cliente = md5(\n                            upper(trim(coalesce(a.c_address, '')))\n                            || upper(trim(coalesce(a.c_comment, '')))\n                            || upper(trim(coalesce(a.c_phone, '')))\n                        )\n                )\n        \n    )\nselect *\nfrom sat_clientes_contacto", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_clientes_contacto", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.286571Z", "completed_at": "2025-08-07T05:06:37.292551Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.292997Z", "completed_at": "2025-08-07T05:06:37.293005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007183551788330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_clientes_cuenta", "compiled": true, "compiled_code": "\n\nwith\n    sat_clientes_cuenta as (\n        select\n            b.hub_cliente_id,\n            b.fecha_carga,\n            md5(\n                upper(trim(nvl(c_acctbal, '')))\n                || upper(trim(nvl(c_comment, '')))\n                || upper(trim(nvl(c_mktsegment, '')))\n            ) as foto_cliente,\n            a.c_origen,\n            a.c_acctbal as cuenta_balance,\n            a.c_comment as comentario,\n            a.c_mktsegment as segmento_marketing\n        from SDGVAULTMART.DBT_SDGVAULT.STG_CLIENTES a\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_CLIENTES b on a.c_name = b.nombre_cliente\n        \n            where\n                not exists (\n                    select 1\n                    from SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_clientes_cuenta s\n                    where\n                        s.hub_cliente_id = b.hub_cliente_id\n                        and s.foto_cliente = md5(\n                            upper(trim(nvl(c_acctbal, '')))\n                            || upper(trim(nvl(c_comment, '')))\n                            || upper(trim(nvl(c_mktsegment, '')))\n                        )\n                )\n        \n    )\nselect *\nfrom sat_clientes_cuenta", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_clientes_cuenta", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.294650Z", "completed_at": "2025-08-07T05:06:37.299384Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.299811Z", "completed_at": "2025-08-07T05:06:37.299818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0059735774993896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_lineas_pedidos", "compiled": true, "compiled_code": "with\n    sat_lineas_pedidos as (\n        select\n            b.hub_lineas_pedido_id,\n            current_date as fecha_carga,\n            md5(\n                upper(trim(nvl(a.l_quantity, '')))\n                || upper(trim(nvl(a.l_extendedprice, '')))\n                || upper(trim(nvl(a.l_discount, '')))\n                || upper(trim(nvl(a.l_tax, '')))\n                || upper(trim(nvl(a.l_returnflag, '')))\n                || upper(trim(nvl(a.l_linestatus, '')))\n                || upper(trim(nvl(a.l_shipdate, '')))\n                || upper(trim(nvl(a.l_commitdate, '')))\n                || upper(trim(nvl(a.l_receiptdate, '')))\n                || upper(trim(nvl(a.l_shipinstruct, '')))\n                || upper(trim(nvl(a.l_shipmode, '')))\n                || upper(trim(nvl(a.l_comment, '')))\n                || upper(trim(nvl(a.l_origen, '')))\n            ) as foto_linea_pedido,\n            a.l_origen,\n            a.l_quantity,\n            a.l_extendedprice,\n            a.l_discount,\n            a.l_tax,\n            a.l_returnflag,\n            a.l_linestatus,\n            a.l_shipdate,\n            a.l_commitdate,\n            a.l_receiptdate,\n            a.l_shipinstruct,\n            a.l_shipmode,\n            a.l_comment\n        from SDGVAULTMART.DBT_SDGVAULT.STG_LINEAS_PEDIDO a\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_LINEAS_PEDIDOS b\n            on a.l_orderkey = b.clave_pedido\n            and a.l_linenumber = b.linea_pedido\n    )\nselect *\nfrom sat_lineas_pedidos", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_lineas_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.301435Z", "completed_at": "2025-08-07T05:06:37.306779Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.307193Z", "completed_at": "2025-08-07T05:06:37.307200Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006516456604003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_paises", "compiled": true, "compiled_code": "\n\nwith\n    sat_paises as (\n        select\n            b.hub_pais_id,\n            b.fecha_carga,\n            md5(upper(trim(nvl(n_comment, '')))) as foto_pais,\n            n_origen,\n            n_comment as comentario\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PAISES a\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PAISES b on a.n_name = b.nombre_pais\n\n        \n            where\n                not exists (\n                    select 1\n                    from SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_paises s\n                    where\n                        s.hub_pais_id = b.hub_pais_id\n                        and s.foto_pais = md5(upper(trim(nvl(n_comment, ''))))\n                )\n        \n    )\nselect *\nfrom sat_paises", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_paises", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.308828Z", "completed_at": "2025-08-07T05:06:37.313701Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.314117Z", "completed_at": "2025-08-07T05:06:37.314123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060882568359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_partes", "compiled": true, "compiled_code": "with\n    sat_partes as (\n        select\n            b.hub_parte_id,\n            current_date as fecha_carga,\n            md5(\n                upper(trim(nvl(a.p_mfgr, '')))\n                || upper(trim(nvl(a.p_type, '')))\n                || upper(trim(nvl(a.p_size, '')))\n                || upper(trim(nvl(a.p_container, '')))\n                || upper(trim(nvl(a.p_retailprice, '')))\n                || upper(trim(nvl(a.p_comment, '')))\n                || upper(trim(nvl(a.p_origen, '')))\n            ) as foto_parte,\n            a.p_origen,\n            a.p_mfgr as fabricante,\n            a.p_type as tipo,\n            a.p_size as medida,\n            a.p_container as contenedor,\n            a.p_retailprice as precio_venta,\n            a.p_comment as comentario,\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PARTES a\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PARTES b\n            on a.p_name = b.nombre_parte\n            and a.p_brand = b.nombre_marca\n    )\nselect *\nfrom sat_partes", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_partes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.316015Z", "completed_at": "2025-08-07T05:06:37.321017Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.321432Z", "completed_at": "2025-08-07T05:06:37.321439Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006171703338623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_partes_proveedores", "compiled": true, "compiled_code": "with\n    sat_partes_proveedores as (\n        select\n            b.hub_parte_id,\n            c.hub_proveedor_id,\n            current_date as fecha_carga,\n            md5(\n                upper(trim(nvl(a.ps_availqty, '')))\n                || upper(trim(nvl(a.ps_supplycost, '')))\n                || upper(trim(nvl(a.ps_comment, '')))\n                || upper(trim(nvl(a.ps_origen, '')))\n            ) as foto_parte_pedido,\n            a.ps_origen,\n            a.ps_availqty as disponibilidad,\n            a.ps_supplycost as coste_envio,\n            a.ps_comment as comentario,\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PARTES_PROVEEDOR a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PARTES a1 on a.ps_partkey = a1.p_partkey\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES a2 on a.ps_suppkey = a2.s_suppkey\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PARTES b\n            on a1.p_name = b.nombre_parte\n            and a1.p_brand = b.nombre_marca\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PROVEEDORES c on a2.s_name = c.nombre_proveedor\n    )\nselect *\nfrom sat_partes_proveedores", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_partes_proveedores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.323098Z", "completed_at": "2025-08-07T05:06:37.328503Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.328917Z", "completed_at": "2025-08-07T05:06:37.328924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006619453430175781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_pedidos", "compiled": true, "compiled_code": "\n\nwith\n    sat_pedidos as (\n        select\n            b.hub_pedido_id,\n            b.fecha_carga,\n            md5(\n                upper(trim(coalesce(a.o_orderstatus, '')))\n                || upper(trim(coalesce(cast(a.o_totalprice as string), '')))\n                || upper(trim(coalesce(cast(a.o_orderdate as string), '')))\n                || upper(trim(coalesce(a.o_orderpriority, '')))\n                || upper(trim(coalesce(a.o_shippriority, '')))\n                || upper(trim(coalesce(a.o_comment, '')))\n            ) as foto_pedido,\n            a.o_origen,\n            a.o_orderstatus as estado_pedido,\n            a.o_totalprice as precio_total,\n            a.o_orderdate as fecha_pedido,\n            a.o_orderpriority as prioridad_ped,\n            a.o_shippriority as prioridad_env,\n            a.o_comment as comentario\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PEDIDOS a\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PEDIDOS b\n            on a.o_orderkey = b.clave_pedido\n            and a.o_clerk = b.empleado\n\n        \n            -- Solo insertar si la versi\u00f3n (foto) no existe ya\n            where\n                not exists (\n                    select 1\n                    from SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_pedidos s\n                    where\n                        s.hub_pedido_id = b.hub_pedido_id\n                        and s.foto_pedido = md5(\n                            upper(trim(coalesce(a.o_orderstatus, '')))\n                            || upper(trim(coalesce(cast(a.o_totalprice as string), '')))\n                            || upper(trim(coalesce(cast(a.o_orderdate as string), '')))\n                            || upper(trim(coalesce(a.o_orderpriority, '')))\n                            || upper(trim(coalesce(a.o_shippriority, '')))\n                            || upper(trim(coalesce(a.o_comment, '')))\n                        )\n                )\n        \n    )\nselect *\nfrom sat_pedidos", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.331088Z", "completed_at": "2025-08-07T05:06:37.335498Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.335926Z", "completed_at": "2025-08-07T05:06:37.335933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006146430969238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_proveedores", "compiled": true, "compiled_code": "with\n    sat_proveedores as (\n        select\n            b.hub_proveedor_id,\n            current_date as fecha_carga,\n            md5(\n                upper(trim(nvl(s_acctbal, '')))\n                || upper(trim(nvl(s_address, '')))\n                || upper(trim(nvl(s_comment, '')))\n                || upper(trim(nvl(s_phone, '')))\n                || upper(trim(nvl(s_origen, '')))\n            ) as foto_proveedor,\n            a.s_origen,\n            a.s_acctbal as cuenta_balance,\n            a.s_address as direccion,\n            a.s_comment as comentario,\n            a.s_phone as telefono\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES a\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PROVEEDORES b on a.s_name = b.nombre_proveedor\n    )\nselect *\nfrom sat_proveedores", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_proveedores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.337640Z", "completed_at": "2025-08-07T05:06:37.341307Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.341723Z", "completed_at": "2025-08-07T05:06:37.341730Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004886150360107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.sat_regiones", "compiled": true, "compiled_code": "with\n    sat_regiones as (\n        select\n            b.hub_region_id,\n            current_date as fecha_carga,\n            md5(\n                upper(trim(nvl(r_comment, ''))) || upper(trim(nvl(r_origen, '')))\n            ) as foto_cliente,\n            a.r_origen,\n            a.r_comment as comentario,\n        from SDGVAULTMART.DBT_SDGVAULT.STG_REGIONES a\n        join SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_REGIONES b on a.r_name = b.nombre_region\n    )\nselect *\nfrom sat_regiones", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.sat_regiones", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.343418Z", "completed_at": "2025-08-07T05:06:37.348301Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.348735Z", "completed_at": "2025-08-07T05:06:37.348742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0061016082763671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_clientes", "compiled": true, "compiled_code": "\n\n-- Fuente condicional de datos seg\u00fan tipo de carga\nwith\n    source_data as (\n\n        \n\n            -- Incremental: datos nuevos desde CSV\n            select\n                c_acctbal,\n                c_address,\n                c_comment,\n                c_custkey,\n                c_mktsegment,\n                c_name,\n                c_nationkey,\n                c_phone,\n                'CSV' as c_origen,\n                current_date - 2 as load_date\n            from SDGVAULTMART.DBT_SDGVAULT.CLIENTES_ELT\n\n        \n\n    )\n\nselect *\nfrom source_data", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_clientes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.350430Z", "completed_at": "2025-08-07T05:06:37.354143Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.354570Z", "completed_at": "2025-08-07T05:06:37.354576Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004948616027832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_lineas_pedido", "compiled": true, "compiled_code": "-- \nwith stg_lineas_pedido as (select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM)\nselect\n    l_orderkey,\n    l_partkey,\n    l_suppkey,\n    l_linenumber,\n    l_quantity,\n    l_extendedprice,\n    l_discount,\n    l_tax,\n    l_returnflag,\n    l_linestatus,\n    l_shipdate,\n    l_commitdate,\n    l_receiptdate,\n    l_shipinstruct,\n    l_shipmode,\n    l_comment,\n    'Snowflake' as l_origen\nfrom stg_lineas_pedido", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_lineas_pedido", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.356280Z", "completed_at": "2025-08-07T05:06:37.360763Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.361181Z", "completed_at": "2025-08-07T05:06:37.361187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005709171295166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_paises", "compiled": true, "compiled_code": "\n\n-- Fuente condicional de datos seg\u00fan tipo de carga\nwith\n    source_data as (\n        \n\n            -- Incremental: datos nuevos desde CSV\n            select\n                n_nationkey,\n                n_name,\n                n_regionkey,\n                n_comment,\n                n_origen,\n                current_date - 2 as load_date\n            from SDGVAULTMART.DBT_SDGVAULT.PAISES_ELT\n\n        \n    )\n\nselect *\nfrom source_data", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_paises", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.362874Z", "completed_at": "2025-08-07T05:06:37.366810Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.367244Z", "completed_at": "2025-08-07T05:06:37.367251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005154132843017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_partes", "compiled": true, "compiled_code": "with stg_partes as (select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PART)\nselect\n    p_partkey,\n    p_name,\n    p_mfgr,\n    p_brand,\n    p_type,\n    p_size,\n    p_container,\n    p_retailprice,\n    p_comment,\n    'Snowflake' as p_origen\nfrom stg_partes", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_partes", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.368985Z", "completed_at": "2025-08-07T05:06:37.372311Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.372734Z", "completed_at": "2025-08-07T05:06:37.372741Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004579067230224609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_partes_proveedor", "compiled": true, "compiled_code": "with stg_partes_proveedor as (select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.PARTSUPP)\nselect\n    ps_partkey,\n    ps_suppkey,\n    ps_availqty,\n    ps_supplycost,\n    ps_comment,\n    'Snowflake' as ps_origen\nfrom stg_partes_proveedor", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_partes_proveedor", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.374433Z", "completed_at": "2025-08-07T05:06:37.378850Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.379271Z", "completed_at": "2025-08-07T05:06:37.379278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005624294281005859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_pedidos", "compiled": true, "compiled_code": "\n\nwith\n    source_data as (\n\n        \n\n            -- Incremental: carga desde CSV\n            select\n                o_orderkey,\n                o_custkey,\n                o_orderstatus,\n                o_totalprice,\n                o_orderdate,\n                o_orderpriority,\n                o_clerk,\n                o_shippriority,\n                o_comment,\n                'CSV' as o_origen,\n                current_date -2 as load_date\n            from SDGVAULTMART.DBT_SDGVAULT.PEDIDOS_ELT\n\n        \n\n    )\n\nselect *\nfrom source_data", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_pedidos", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.381018Z", "completed_at": "2025-08-07T05:06:37.386588Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.387039Z", "completed_at": "2025-08-07T05:06:37.387047Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0068509578704833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_proveedores", "compiled": true, "compiled_code": "with stg_proveedor as (select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.SUPPLIER)\nselect\n    s_suppkey,\n    s_name,\n    s_address,\n    s_nationkey,\n    s_phone,\n    s_acctbal,\n    s_comment,\n    'Snowflake' as s_origen\nfrom stg_proveedor", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_proveedores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.388818Z", "completed_at": "2025-08-07T05:06:37.392255Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.392676Z", "completed_at": "2025-08-07T05:06:37.392683Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0046844482421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.stg_regiones", "compiled": true, "compiled_code": "with stg_partes_region as (select * from SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.REGION)\nselect r_regionkey, r_name, r_comment, 'Snowflake' as r_origen\nfrom stg_partes_region", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.stg_regiones", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.394449Z", "completed_at": "2025-08-07T05:06:37.398581Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.399026Z", "completed_at": "2025-08-07T05:06:37.399033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005403041839599609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_business_bridge_pedidos_eu", "compiled": true, "compiled_code": "\n\nselect *\nfrom SDGVAULTMART.DBT_SDGVAULT_BRONZE.BRIDGE_PEDIDOS\nwhere\n    nombre_pais\n    in ('ESPA\u00d1A', 'GERMANY', 'RUSSIA', 'ROMANIA', 'UNITED KINGDOM', 'FRANCE', 'ITALIA')", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.v_business_bridge_pedidos_eu", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.400824Z", "completed_at": "2025-08-07T05:06:37.406690Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.407115Z", "completed_at": "2025-08-07T05:06:37.407122Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007170438766479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_hub_sat_pedidos_eu", "compiled": true, "compiled_code": "\n\nwith\n    v_hub_sat_pedidos_eu as (\n        select\n            hpe.hub_pedido_id,\n            hpe.clave_pedido as hub_clave_pedido,\n            hpe.empleado as hub_empleado,\n            hpe.fecha_carga as hub_fecha_carga,\n            hpe.origen as hub_origen,\n            spe.fecha_carga as sat_fecha_carga,\n            spe.foto_pedido as sat_foto_pedido,\n            spe.o_origen as sat_origen,\n            spe.estado_pedido as sat_estado_pedido,\n            spe.precio_total as sat_precio_total,\n            spe.fecha_pedido as sat_fecha_pedido,\n            spe.prioridad_env as sat_prioridad_env,\n            spe.prioridad_ped as sat_prioridad_ped,\n            spe.comentario as sat_comentario\n        from SDGVAULTMART.DBT_SDGVAULT_BRONZE.HUB_PEDIDOS hpe\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.SAT_PEDIDOS spe\n            on hpe.hub_pedido_id = spe.hub_pedido_id\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_CLIENTES_PEDIDOS lcp\n            on hpe.hub_pedido_id = lcp.hub_pedido_id\n        join\n            SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_PAISES_CLIENTES lpc\n            on lcp.hub_cliente_id = lpc.hub_cliente_id\n            and lpc.nombre_pais\n            in ('ESPA\u00d1A', 'GERMANY', 'RUSSIA', 'ROMANIA', 'UNITED KINGDOM', 'FRANCE')\n    )\nselect *\nfrom v_hub_sat_pedidos_eu", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.v_hub_sat_pedidos_eu", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.408848Z", "completed_at": "2025-08-07T05:06:37.413046Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.413487Z", "completed_at": "2025-08-07T05:06:37.413495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005459785461425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_raw_lnk_clientes_pedidos_eu", "compiled": true, "compiled_code": "\n\nselect lcp.*\nfrom SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_CLIENTES_PEDIDOS lcp\njoin\n    SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_PAISES_CLIENTES lpc\n    on lcp.hub_cliente_id = lpc.hub_cliente_id\n    and lpc.nombre_pais\n    in ('ESPA\u00d1A', 'GERMANY', 'RUSSIA', 'ROMANIA', 'UNITED KINGDOM', 'FRANCE')", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.v_raw_lnk_clientes_pedidos_eu", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.415253Z", "completed_at": "2025-08-07T05:06:37.419386Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.419809Z", "completed_at": "2025-08-07T05:06:37.419819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005408287048339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_raw_lnk_paises_clientes_eu", "compiled": true, "compiled_code": "\n\nselect *\nfrom SDGVAULTMART.DBT_SDGVAULT_BRONZE.LNK_PAISES_CLIENTES\nwhere\n    nombre_pais\n    in ('ESPA\u00d1A', 'GERMANY', 'RUSSIA', 'ROMANIA', 'UNITED KINGDOM', 'FRANCE')", "relation_name": "SDGVAULTMART.DBT_SDGVAULT_BRONZE.v_raw_lnk_paises_clientes_eu", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.421599Z", "completed_at": "2025-08-07T05:06:37.425583Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.426004Z", "completed_at": "2025-08-07T05:06:37.426010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005258798599243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_stg_regiones_paises", "compiled": true, "compiled_code": "\n\nselect a.*, b.*\nfrom SDGVAULTMART.DBT_SDGVAULT.STG_REGIONES a\njoin SDGVAULTMART.DBT_SDGVAULT.STG_PAISES b on a.r_regionkey = b.n_regionkey", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.v_stg_regiones_paises", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.427821Z", "completed_at": "2025-08-07T05:06:37.428836Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.429257Z", "completed_at": "2025-08-07T05:06:37.429263Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0023088455200195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.SDG_Vault_demo.clientes_elt", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.431026Z", "completed_at": "2025-08-07T05:06:37.432391Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.432809Z", "completed_at": "2025-08-07T05:06:37.432816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0026023387908935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.SDG_Vault_demo.paises_elt", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.434715Z", "completed_at": "2025-08-07T05:06:37.435701Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.436102Z", "completed_at": "2025-08-07T05:06:37.436108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002206563949584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.SDG_Vault_demo.pedidos_elt", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.438235Z", "completed_at": "2025-08-07T05:06:37.443254Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.443705Z", "completed_at": "2025-08-07T05:06:37.443712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0062749385833740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_stg_clientes_pedidos_eu", "compiled": true, "compiled_code": "\n\nwith\n    stg_clientes_pedidos_europa as (\n        select\n            c_acctbal,\n            c_address,\n            c_comment,\n            c_custkey,\n            c_mktsegment,\n            c_name,\n            c_nationkey,\n            c_phone,\n            c_origen,\n            a.load_date as fecha_cliente,\n            o_orderkey,\n            o_custkey,\n            o_orderstatus,\n            o_totalprice,\n            o_orderdate,\n            o_orderpriority,\n            o_clerk,\n            o_shippriority,\n            o_comment,\n            o_origen,\n            b.load_date as fecha_pedido,\n            r_regionkey,\n            r_name,\n            r_comment,\n            r_origen,\n            n_nationkey,\n            n_name,\n            n_regionkey,\n            n_comment,\n            n_origen,\n            c.load_date as fecha_pais\n        from SDGVAULTMART.DBT_SDGVAULT.STG_CLIENTES a\n        left join SDGVAULTMART.DBT_SDGVAULT.STG_PEDIDOS b on a.c_custkey = b.o_custkey\n        join\n            SDGVAULTMART.DBT_SDGVAULT.v_stg_regiones_paises c\n            on a.c_nationkey = c.n_nationkey\n            and c.n_regionkey = 3\n    )\nselect *\nfrom stg_clientes_pedidos_europa", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.v_stg_clientes_pedidos_eu", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-07T05:06:37.445427Z", "completed_at": "2025-08-07T05:06:37.450368Z"}, {"name": "execute", "started_at": "2025-08-07T05:06:37.450817Z", "completed_at": "2025-08-07T05:06:37.450824Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0062067508697509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.SDG_Vault_demo.v_stg_provee_partes_pedidos_eu", "compiled": true, "compiled_code": "\n\nwith\n    stg_provee_partes_pedidos_europa as (\n        select *\n        from SDGVAULTMART.DBT_SDGVAULT.STG_PROVEEDORES a\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PARTES_PROVEEDOR b on a.s_suppkey = b.ps_suppkey\n        join SDGVAULTMART.DBT_SDGVAULT.STG_PARTES c on b.ps_partkey = c.p_partkey\n        join\n            SDGVAULTMART.DBT_SDGVAULT.v_stg_regiones_paises d\n            on a.s_nationkey = d.n_nationkey\n            and d.n_nationkey in (6, 19, 22, 23, 99, 7)\n    )\nselect *\nfrom stg_provee_partes_pedidos_europa", "relation_name": "SDGVAULTMART.DBT_SDGVAULT.v_stg_provee_partes_pedidos_eu", "batch_results": null}], "elapsed_time": 1.8447239398956299, "args": {"require_generic_test_arguments_property": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": true, "show_all_deprecations": false, "source_freshness_run_project_hooks": true, "log_file_max_bytes": 10485760, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "skip_nodes_if_on_run_start_fails": false, "compile": true, "introspect": true, "macro_debugging": false, "log_level_file": "debug", "profiles_dir": "C:\\Users\\0021643\\.dbt", "require_all_warnings_handled_by_warn_error": false, "show_resource_report": false, "vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "state_modified_compare_more_unrendered_values": false, "use_fast_test_edges": false, "indirect_selection": "eager", "exclude": [], "use_colors": true, "defer": false, "validate_macro_args": false, "cache_selected_only": false, "upload_to_artifacts_ingest_api": false, "version_check": true, "static": false, "printer_width": 80, "log_format": "default", "state_modified_compare_vars": false, "partial_parse": true, "require_yaml_configuration_for_mf_time_spines": false, "log_level": "info", "log_path": "C:\\Users\\0021643\\Documents\\Practica\\proyecto-git\\gobdat\\logs", "strict_mode": false, "print": true, "which": "generate", "empty_catalog": false, "project_dir": "C:\\Users\\0021643\\Documents\\Practica\\proyecto-git\\gobdat", "require_resource_names_without_spaces": true, "send_anonymous_usage_stats": true, "log_format_file": "debug", "populate_cache": true, "quiet": false, "static_parser": true, "favor_state": false, "use_colors_file": true, "partial_parse_file_diff": true, "invocation_command": "dbt docs generate"}}